<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

    <script>
        AFRAME.registerComponent('employee-face', {
            schema: {
                url: { default : ''}
            },
            init: function () {
                var lastIndex = -1;
                var visible = ['true', 'false'];
                var data = this.data;
                var el = this.el;
                console.log("data is" + data );
                console.log(el);
                el.addEventListener('click', function (event) {
                    console.log("image clicked");
                });
                document.addEventListener('click', function (event) {  
                    var box = document.getElementById("id-card-plane");
                    lastIndex = (lastIndex + 1) % visible.length;
                    if (visible[lastIndex] === 'true') {
                        console.log('I was clicked');
                        document.querySelector('#id-card-plane').emit('journeyDetailsAnimation');
                    }
                    box.setAttribute('visible', `${visible[lastIndex]}`)
                });
                
            }
        });
    </script>
</head>

<body>
    <a-scene embedded arjs='trackingMethod: best;'>
        <a-assets>
            <img id="emp-face" src="./images/id-face.jpg">
            </img>
            <img id="id-card" src="./images/Employee-id-48-CRC.jpg" />
        </a-assets>

        <!-- <a-marker preset='custom' type='pattern' url='./patterns/train-ticket.patt'> -->
        <a-marker preset='hiro'>
               
            <a-entity id="id-card-plane" geometry="primitive: plane;  width: 1; height: 1; " 
                position="1.2 0 0" width="1" height="1" rotation="-90 0 0"
                material="shader: flat; src: #id-card ;transparent: true; opacity: 0.5;" visible="false"
                animation="property: position; from: 1 0 0; to: 1.3 0 0; dur: 1000; easing: linear; loop: false ; startEvents: journeyDetailsAnimation;">
            </a-entity>                
            
            <a-entity id="emp-face-entity" employee-face="url: abc" geometry="primitive: plane;  width:1;  height: 1;"
                material="shader: flat; src: #emp-face;" visible="true" scale="1 1 1"
                rotation="-90 0 0"  >
            </a-entity>
            
        </a-marker>

        <a-entity camera></a-entity>
    </a-scene>
</body>

</html>